<!DOCTYPE html>
<html>
	<head>
		<link href="publication-web-resources/css/main.css" rel="stylesheet" type="text/css">
		<script src="publication-web-resources/script/main.js" type="text/javascript"></script>
        
        <style>
            /* 1. Main Window Settings */
            body, html {
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100%;
                background-color: #fafafa; /* Very Light Grey (Almost White) */
                overflow: hidden; 
            }

            /* 2. Make the iframe fill the screen */
            #contentIFrame {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                border: none;
            }
        </style>

        <script>
            function forceCenterLayout() {
                var iframe = document.getElementById("contentIFrame");
                var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
                
                // Find the main InDesign container (the one with the width/height set)
                // We look for the first div directly inside body
                var mainDiv = innerDoc.querySelector('body > div');
                
                if (mainDiv) {
                    // Read the width and height InDesign assigned to the page
                    var w = parseFloat(mainDiv.style.width) || mainDiv.offsetWidth;
                    var h = parseFloat(mainDiv.style.height) || mainDiv.offsetHeight;

                    // Calculate half sizes for centering
                    var halfW = w / 2;
                    var halfH = h / 2;

                    // Create a style tag to inject safe centering CSS
                    var style = innerDoc.createElement('style');
                    style.innerHTML = `
                        /* Make sure the iframe body is transparent so our grey background shows */
                        body {
                            background-color: transparent !important;
                            overflow: hidden !important;
                        }

                        /* 
                           SAFE CENTERING:
                           1. We set position: absolute (restoring InDesign's default).
                           2. We move the Starting Point to the exact center (left: 50%, top: 50%).
                           3. We pull the page back by half its size using margins.
                           
                           *Crucially* we DO NOT touch 'transform', so animations still work!
                        */
                        body > div {
                            position: absolute !important;
                            left: 50% !important;
                            top: 50% !important;
                            margin-left: -${halfW}px !important;
                            margin-top: -${halfH}px !important;
                            
                            /* Optional: Add a nice shadow */
                            box-shadow: 0 0 30px rgba(0,0,0,0.1); 
                        }
                    `;
                    innerDoc.head.appendChild(style);
                }
            }
        </script>
	</head>
    
    <!-- Delay slightly to ensure InDesign has created the divs before we measure them -->
	<body onload="showHideArrows()">
		<iframe onload="showHideArrows(); setTimeout(forceCenterLayout, 200);" id="contentIFrame" class="contentIframeClass" src="publication-web-resources/html/publication.html"></iframe>
		
        <iframe id="dummyIFrame" class="dummyFrameClass"></iframe>
		<div class="prev" onclick="showPreviousPage()">&#10094;</div>
		<div class="next" onclick="showNextPage()">&#10095;</div>
	</body>
</html>
